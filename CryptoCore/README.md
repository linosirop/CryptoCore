README — CryptoCore AES-128
1. Назначение

CryptoCore — консольное приложение для шифрования и расшифрования файлов с использованием алгоритма AES-128 в режимах ECB, CBC, CFB, OFB, CTR.
Реализация совместима с OpenSSL enc и поддерживает бинарный файловый ввод/вывод.

2. Возможности

AES-128 шифрование и дешифрование

Поддержка режимов:

ECB

CBC

CFB

OFB

CTR

PKCS#7 padding (только для ECB и CBC)

Потоковые режимы (CFB/OFB/CTR) без padding

Автоматическая генерация IV при шифровании

Чтение IV из файла (префикс) при дешифровании

Совместимость с OpenSSL по ciphertext-формату

Проверка слабых ключей (weak-key detection)

Работа с файлами больших размеров (ограничение — доступная RAM)

3. Системные требования

Windows (MSVC) или Linux (g++)

C++17

OpenSSL 3.x или совместимый

4. Формат использования
cryptocore --algorithm aes --mode <mode> (--encrypt | --decrypt)
            --key <32-hex>
            --input <файл>
            --output <файл>
            [--iv <32-hex>]

Параметры
Параметр	Описание
--algorithm aes	Алгоритм (обязательно)
--mode	ecb / cbc / cfb / ofb / ctr
--encrypt	Шифровать
--decrypt	Расшифровать
--key	AES-128 ключ (32 hex символа)
--iv	IV (только для режимов ≠ ECB)
--input	Входной файл
--output	Выходной файл
5. Примеры
ECB шифрование
cryptocore --algorithm aes --mode ecb --encrypt --key 00112233445566778899aabbccddeeff--input plain.bin --output enc.bin
            
           

CBC расшифрование
cryptocore --algorithm aes --mode cbc --decrypt --key 00112233445566778899aabbccddeeff--input enc.bin --output dec.bin
            
           

6. Формат файлов
ECB
ciphertext


(IV не используется)

CBC / CFB / OFB / CTR

При шифровании если IV не указан явно:

[16 bytes IV] + [ciphertext]


При дешифровании:

если --iv указан → файл содержит чистый ciphertext

если --iv отсутствует → IV читается из первых 16 байт

Формат полностью совместим с OpenSSL.

7. Реализация

AES-блоки вычисляются через OpenSSL AES_encrypt/AES_decrypt.

CBC/CFB/OFB/CTR реализованы пошаговой обработкой блока (ручная логика).

PKCS#7:

применяется в ECB и CBC

не используется в CFB/OFB/CTR

Чтение/запись файла — бинарное, целиком в память.

8. Weak-Key Detection

Программа автоматически анализирует ключ AES-128 и выводит предупреждение (в stderr) при обнаружении слабых шаблонов.

Слабые ключи

All-zero key

00000000000000000000000000000000
→ выводит: [WEAK-KEY-ZERO]


Sequential key

000102030405060708090A0B0C0D0E0F
→ выводит: [WEAK-KEY-SEQ]


Эти сообщения не влияют на работу алгоритма, но предупреждают о небезопасном использовании ключей.

9. Тестирование
1) Совместимость с OpenSSL

Проведено сравнение:

шифрование всех режимов

дешифрование

работа с IV

PKCS#7 padding

Все ciphertext/плейнтексты совпадают с результатами openssl enc.

2) Проверка на больших данных

Проверено шифрование файлов до 1 GiB.
Ограничение — объём RAM, так как файл читается целиком.

3) NIST SP 800-38A корректность

Проверено на тестовых векторах NIST Known Answer Tests:

ECB 128-bit

CBC 128-bit

CFB128

OFB128

CTR128

Результаты идентичны эталонным.

4) Автотесты

Для автоматической проверки есть тестовый скрипт:

tests/test_all_modes.bat

10. Ограничения

Файлы читаются в память полностью → максимальный размер ограничен RAM.

Нет потоковой обработки (streaming) — планируется в следующей версии.

Поддерживается только AES-128 (AES-192/256 отсутствуют).

IV всегда 16 байт (128 бит).

11. Статус проекта

Реализация на 100% рабочая и совместимая с OpenSSL для всех режимов.
Поддерживает weak-key анализ и проверена по NIST тестам